#define N_POLES 2
#define V_S_FALLBACK 400

// 1024 values of sin ranging between -32768 and 32767
int fastsin[] = {
2365, 2374, 2384, 2394, 2404, 2413, 2423, 2433, 2442, 2451, 2462, 2471, 2480, 2491, 2500, 2510, 2520, 2529, 2539, 2548, 2558, 2568, 2577, 2587, 2597, 2606, 2615, 2626, 2635, 2644, 2655, 2664, 2673, 2684, 2693, 2702, 2712, 2722, 2731, 2740, 2750, 2760, 2769, 2778, 2789, 2798, 2807, 2816, 2827, 2836, 2845, 2854, 2864, 2874, 2883, 2893, 2902, 2911, 2920, 2929, 2940, 2949, 2958, 2968, 2977, 2986, 2995, 3005, 3014, 3023, 3032, 3041, 3052, 3061, 3070, 3080, 3088, 3097, 3106, 3115, 3125, 3134, 3143, 3152, 3162, 3171, 3180, 3189, 3197, 3207, 3216, 3225, 3234, 3242, 3252, 3261, 3270, 3278, 3287, 3297, 3306, 3314, 3323, 3332, 3341, 3350, 3358, 3367, 3376, 3384, 3394, 3402, 3411, 3419, 3428, 3436, 3446, 3454, 3463, 3471, 3479, 3488, 3496, 3506, 3514, 3522, 3530, 3539, 3547, 3555, 3563, 3573, 3581, 3589, 3597, 3605, 3613, 3622, 3630, 3638, 3647, 3655, 3663, 3671, 3679, 3687, 3695, 3703, 3711, 3718, 3726, 3734, 3742, 3750, 3757, 3765, 3774, 3782, 3789, 3797, 3805, 3812, 3820, 3828, 3835, 3843, 3850, 3858, 3865, 3873, 3880, 3888, 3895, 3902, 3910, 3917, 3924, 3932, 3939, 3946, 3953, 3961, 3968, 3974, 3981, 3988, 3995, 4002, 4009, 4016, 4023, 4030, 4037, 4044, 4051, 4058, 4065, 4070, 4077, 4084, 4091, 4097, 4104, 4111, 4117, 4123, 4130, 4136, 4143, 4149, 4156, 4162, 4168, 4174, 4180, 4187, 4193, 4198, 4205, 4211, 4217, 4223, 4230, 4235, 4241, 4247, 4253, 4259, 4264, 4270, 4276, 4282, 4287, 4293, 4298, 4304, 4309, 4315, 4320, 4326, 4331, 4336, 4342, 4347, 4352, 4358, 4362, 4368, 4373, 4379, 4383, 4388, 4394, 4398, 4403, 4407, 4413, 4418, 4423, 4427, 4432, 4436, 4441, 4446, 4450, 4455, 4459, 4464, 4469, 4473, 4477, 4481, 4486, 4489, 4494, 4499, 4502, 4507, 4510, 4515, 4518, 4523, 4526, 4531, 4535, 4538, 4543, 4546, 4550, 4553, 4556, 4561, 4565, 4568, 4571, 4575, 4578, 4582, 4585, 4588, 4591, 4595, 4598, 4601, 4604, 4607, 4611, 4613, 4616, 4619, 4622, 4625, 4628, 4630, 4634, 4636, 4638, 4642, 4644, 4647, 4649, 4651, 4653, 4657, 4659, 4662, 4664, 4666, 4668, 4670, 4672, 4674, 4677, 4679, 4680, 4682, 4685, 4686, 4688, 4689, 4692, 4693, 4695, 4696, 4698, 4700, 4701, 4703, 4704, 4705, 4707, 4708, 4709, 4711, 4712, 4713, 4715, 4716, 4716, 4717, 4718, 4719, 4720, 4720, 4722, 4723, 4723, 4724, 4725, 4725, 4726, 4726, 4727, 4727, 4727, 4728, 4728, 4728, 4728, 4730, 4730, 4730, 4730, 4730, 4730, 4730, 4730, 4730, 4730, 4730, 4728, 4728, 4728, 4728, 4727, 4727, 4727, 4726, 4726, 4725, 4725, 4724, 4723, 4723, 4722, 4720, 4720, 4719, 4718, 4717, 4716, 4716, 4715, 4713, 4712, 4711, 4709, 4708, 4707, 4705, 4704, 4703, 4701, 4700, 4698, 4696, 4695, 4693, 4692, 4689, 4688, 4686, 4685, 4682, 4680, 4679, 4677, 4674, 4672, 4670, 4668, 4666, 4664, 4662, 4659, 4657, 4653, 4651, 4649, 4647, 4644, 4642, 4638, 4636, 4634, 4630, 4628, 4625, 4622, 4619, 4616, 4613, 4611, 4607, 4604, 4601, 4598, 4595, 4591, 4588, 4585, 4582, 4578, 4575, 4571, 4568, 4565, 4561, 4556, 4553, 4550, 4546, 4543, 4538, 4535, 4531, 4526, 4523, 4518, 4515, 4510, 4507, 4502, 4499, 4494, 4489, 4486, 4481, 4477, 4473, 4469, 4464, 4459, 4455, 4450, 4446, 4441, 4436, 4432, 4427, 4423, 4418, 4413, 4407, 4403, 4398, 4394, 4388, 4383, 4379, 4373, 4368, 4362, 4358, 4352, 4347, 4342, 4336, 4331, 4326, 4320, 4315, 4309, 4304, 4298, 4293, 4287, 4282, 4276, 4270, 4264, 4259, 4253, 4247, 4241, 4235, 4230, 4223, 4217, 4211, 4205, 4198, 4193, 4187, 4180, 4174, 4168, 4162, 4156, 4149, 4143, 4136, 4130, 4123, 4117, 4111, 4104, 4097, 4091, 4084, 4077, 4070, 4065, 4058, 4051, 4044, 4037, 4030, 4023, 4016, 4009, 4002, 3995, 3988, 3981, 3974, 3968, 3961, 3953, 3946, 3939, 3932, 3924, 3917, 3910, 3902, 3895, 3888, 3880, 3873, 3865, 3858, 3850, 3843, 3835, 3828, 3820, 3812, 3805, 3797, 3789, 3782, 3774, 3765, 3757, 3750, 3742, 3734, 3726, 3718, 3711, 3703, 3695, 3687, 3679, 3671, 3663, 3655, 3647, 3638, 3630, 3622, 3613, 3605, 3597, 3589, 3581, 3573, 3563, 3555, 3547, 3539, 3530, 3522, 3514, 3506, 3496, 3488, 3479, 3471, 3463, 3454, 3446, 3436, 3428, 3419, 3411, 3402, 3394, 3384, 3376, 3367, 3358, 3350, 3341, 3332, 3323, 3314, 3306, 3297, 3287, 3278, 3270, 3261, 3252, 3242, 3234, 3225, 3216, 3207, 3197, 3189, 3180, 3171, 3162, 3152, 3143, 3134, 3125, 3115, 3106, 3097, 3088, 3080, 3070, 3061, 3052, 3041, 3032, 3023, 3014, 3005, 2995, 2986, 2977, 2968, 2958, 2949, 2940, 2929, 2920, 2911, 2902, 2893, 2883, 2874, 2864, 2854, 2845, 2836, 2827, 2816, 2807, 2798, 2789, 2778, 2769, 2760, 2750, 2740, 2731, 2722, 2712, 2702, 2693, 2684, 2673, 2664, 2655, 2644, 2635, 2626, 2615, 2606, 2597, 2587, 2577, 2568, 2558, 2548, 2539, 2529, 2520, 2510, 2500, 2491, 2480, 2471, 2462, 2451, 2442, 2433, 2423, 2413, 2404, 2394, 2384, 2374, 2365, 2356, 2345, 2336, 2326, 2316, 2307, 2297, 2287, 2278, 2268, 2259, 2249, 2239, 2230, 2219, 2210, 2201, 2190, 2181, 2172, 2162, 2152, 2143, 2133, 2123, 2114, 2104, 2095, 2085, 2075, 2066, 2057, 2046, 2037, 2028, 2017, 2008, 1999, 1990, 1979, 1970, 1961, 1951, 1941, 1932, 1923, 1913, 1903, 1894, 1884, 1875, 1866, 1856, 1846, 1837, 1828, 1819, 1809, 1800, 1790, 1781, 1771, 1762, 1753, 1744, 1734, 1725, 1716, 1707, 1697, 1688, 1678, 1669, 1659, 1650, 1642, 1633, 1624, 1614, 1605, 1596, 1587, 1577, 1568, 1559, 1550, 1540, 1532, 1523, 1514, 1505, 1495, 1487, 1478, 1469, 1460, 1451, 1442, 1433, 1424, 1416, 1406, 1397, 1389, 1380, 1372, 1363, 1353, 1345, 1336, 1328, 1319, 1311, 1301, 1293, 1284, 1276, 1267, 1259, 1251, 1241, 1233, 1224, 1216, 1208, 1200, 1190, 1182, 1174, 1166, 1157, 1149, 1141, 1133, 1125, 1117, 1107, 1099, 1091, 1083, 1075, 1067, 1059, 1051, 1043, 1035, 1027, 1018, 1012, 1003, 995, 987, 979, 972, 964, 956, 948, 941, 933, 925, 918, 910, 902, 895, 887, 880, 872, 865, 857, 850, 842, 835, 828, 820, 813, 806, 798, 791, 784, 777, 769, 762, 755, 748, 741, 734, 727, 721, 714, 707, 700, 693, 686, 679, 672, 665, 659, 652, 645, 639, 633, 626, 619, 613, 606, 599, 594, 587, 581, 574, 568, 561, 555, 550, 543, 537, 531, 524, 518, 513, 507, 500, 494, 488, 483, 477, 471, 465, 460, 454, 448, 442, 436, 432, 426, 420, 415, 410, 404, 398, 394, 388, 382, 378, 372, 367, 361, 357, 351, 346, 342, 336, 331, 327, 322, 316, 312, 307, 303, 298, 293, 289, 284, 279, 275, 270, 266, 261, 256, 253, 248, 244, 240, 236, 231, 227, 223, 219, 215, 211, 207, 203, 199, 195, 192, 187, 184, 180, 177, 173, 169, 165, 162, 158, 155, 151, 148, 144, 142, 139, 135, 132, 128, 126, 122, 119, 117, 113, 111, 107, 105, 102, 99, 96, 94, 91, 88, 85, 83, 81, 79, 76, 73, 70, 68, 66, 64, 61, 60, 58, 55, 53, 51, 50, 47, 45, 44, 42, 40, 38, 37, 35, 33, 31, 30, 29, 27, 25, 24, 23, 22, 21, 18, 17, 16, 15, 14, 14, 13, 12, 10, 9, 9, 8, 7, 7, 6, 5, 5, 3, 3, 2, 2, 2, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 3, 3, 5, 5, 6, 7, 7, 8, 9, 9, 10, 12, 13, 14, 14, 15, 16, 17, 18, 21, 22, 23, 24, 25, 27, 29, 30, 31, 33, 35, 37, 38, 40, 42, 44, 45, 47, 50, 51, 53, 55, 58, 60, 61, 64, 66, 68, 70, 73, 76, 79, 81, 83, 85, 88, 91, 94, 96, 99, 102, 105, 107, 111, 113, 117, 119, 122, 126, 128, 132, 135, 139, 142, 144, 148, 151, 155, 158, 162, 165, 169, 173, 177, 180, 184, 187, 192, 195, 199, 203, 207, 211, 215, 219, 223, 227, 231, 236, 240, 244, 248, 253, 256, 261, 266, 270, 275, 279, 284, 289, 293, 298, 303, 307, 312, 316, 322, 327, 331, 336, 342, 346, 351, 357, 361, 367, 372, 378, 382, 388, 394, 398, 404, 410, 415, 420, 426, 432, 436, 442, 448, 454, 460, 465, 471, 477, 483, 488, 494, 500, 507, 513, 518, 524, 531, 537, 543, 550, 555, 561, 568, 574, 581, 587, 594, 599, 606, 613, 619, 626, 633, 639, 645, 652, 659, 665, 672, 679, 686, 693, 700, 707, 714, 721, 727, 734, 741, 748, 755, 762, 769, 777, 784, 791, 798, 806, 813, 820, 828, 835, 842, 850, 857, 865, 872, 880, 887, 895, 902, 910, 918, 925, 933, 941, 948, 956, 964, 972, 979, 987, 995, 1003, 1012, 1018, 1027, 1035, 1043, 1051, 1059, 1067, 1075, 1083, 1091, 1099, 1107, 1117, 1125, 1133, 1141, 1149, 1157, 1166, 1174, 1182, 1190, 1200, 1208, 1216, 1224, 1233, 1241, 1251, 1259, 1267, 1276, 1284, 1293, 1301, 1311, 1319, 1328, 1336, 1345, 1353, 1363, 1372, 1380, 1389, 1397, 1406, 1416, 1424, 1433, 1442, 1451, 1460, 1469, 1478, 1487, 1495, 1505, 1514, 1523, 1532, 1540, 1550, 1559, 1568, 1577, 1587, 1596, 1605, 1614, 1624, 1633, 1642, 1650, 1659, 1669, 1678, 1688, 1697, 1707, 1716, 1725, 1734, 1744, 1753, 1762, 1771, 1781, 1790, 1800, 1809, 1819, 1828, 1837, 1846, 1856, 1866, 1875, 1884, 1894, 1903, 1913, 1923, 1932, 1941, 1951, 1961, 1970, 1979, 1990, 1999, 2008, 2017, 2028, 2037, 2046, 2057, 2066, 2075, 2085, 2095, 2104, 2114, 2123, 2133, 2143, 2152, 2162, 2172, 2181, 2190, 2201, 2210, 2219, 2230, 2239, 2249, 2259, 2268, 2278, 2287, 2297, 2307, 2316, 2326, 2336, 2345, 2356, 2365
};

void generatePWMs() {

    int va = 0;
    int vb = 0;
    int vc = 0;

    // Target phase voltages for phases a, b and c

    int v1; unsigned short pw1;
    int v2; unsigned short pw2;
    int v3; unsigned short pw3;

    double vCommand;

    // The voltages at terminals 1, 2, and 3. Pulse width fraction at terminals 1, 2 and 3
    //
    // pulse width goes from 0 to 8,192 (2^13)


    pw1 = v1 * vCommand;
    pw2 = v2 * vCommand;
    pw3 = v3 * vCommand;

}
